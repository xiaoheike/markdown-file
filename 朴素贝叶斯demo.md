## 了解什么是“朴素贝叶斯” ##
上周有了新的需求，做一个分类器。经过大家的讨论暂时定使用“朴素贝叶斯算法”实现文本分类。在这次工作之前我是完全没有触碰过分类器的相关知识的，所以对于“朴素贝叶斯算法”自然也是一无所知。好吧，其实我知道有这个人名。随后我在网络上检索自己想要的内容，找到了一篇比较好的牵线的文章：[http://www.ruanyifeng.com/blog/2013/12/naive_bayes_classifier.html](http://www.ruanyifeng.com/blog/2013/12/naive_bayes_classifier.html "朴素贝叶斯的应用")。看完之后算是对于朴素贝叶斯有了认识了。
之后是反复看到不同博主的相同文章：[http://blog.csdn.net/kongying168/article/details/7026389](http://blog.csdn.net/kongying168/article/details/7026389 "朴素贝叶斯的中文")。我认真的看完了，也有了一些收获。反复换关键词，但是检索到的内容都相差无几，而且很多都是转载的。都搞不懂哪个才是原创了。通过谷歌搜索，找到了文章：[http://nlp.stanford.edu/IR-book/html/htmledition/naive-bayes-text-classification-1.html](http://nlp.stanford.edu/IR-book/html/htmledition/naive-bayes-text-classification-1.html "多项式朴素贝叶斯英文")，发现相同的例子但是多项式贝叶斯算法的计算却是不一样的。

中文中例子计算方法：

![朴素贝叶斯算法--单词分类列子(中文博客)](http://i.imgur.com/YDveAwW.png)

外文中相同例子不同的计算方法：

![朴素贝叶斯算法--单词分类列子(英文文章)](http://i.imgur.com/h5sFAOj.png)

由于我对于朴素贝叶斯算法并不熟悉，所以我没有马上下定论，只是心存怀疑。

只会找到了一篇很好的英文文章：[http://sebastianraschka.com/Articles/2014_naive_bayes_1.html](http://sebastianraschka.com/Articles/2014_naive_bayes_1.html "朴素贝叶斯论文")。这篇文章将使用朴素贝叶斯算法分类的过程讲述得比较清楚了。从这篇文章中大致可以断定中文博客中讲述的例子是有偏差的。

## 如何实现 ##
知道了算法的原理之后就到实现了。我很庆幸在github上找到了2个源码。第一篇：[https://github.com/ptnplanet/Java-Naive-Bayes-Classifier](https://github.com/ptnplanet/Java-Naive-Bayes-Classifier "朴素贝叶斯算法源码（不合理）")。我认真阅读之后，发现最后一步的计算和多项式朴素贝叶斯算法对不上，当然得要经过测试才能够知道到底是否正确。先给出训练数据，是一个excel文件，里边包含10886条数据，每条数据包含一个分类以及一些描述关键词，比如：分类：武器，描述：作战、现代武器。另外准备了一份excel，里边包含5000条数据，每条数据包含要匹配的词汇以及实际分类，比如：线灰蝶,动物，分类：动物。这样我就可以在训练完毕之后去匹配这5000条数据，最后的测试结果为：
![github朴素贝叶斯算法源码(不靠谱)运行结果](http://i.imgur.com/fwn6meV.png)

5000条数据正确命中为1428，命中率为：28.56%

第二个github源码：[https://github.com/datumbox/NaiveBayesClassifier](https://github.com/datumbox/NaiveBayesClassifier "朴素贝叶斯算法源码（合理）")。这篇我看懂了，是很标准的多项式朴素贝叶斯算法，采用拉普拉斯平滑。而且这篇源码里边对输入关键词还做了卡方校验，我觉得很优秀。与项目组的另外一名做数据分析的同学讨论之后，他不懂java代码，他说最后的计算不靠谱。我是看懂的，我想向他解释的，但是似乎没有认真听。该代码中最后的计算使用了对数公式log(M·N)=logM + logN。因为他不懂java代码，所以他觉得不可信。事后我抽出时间对该源码做了测试。和上述的那个源码的测试是相同的，测试数据也一致，测试结果，截图如下：

![github朴素贝叶斯算法源码(靠谱)运行结果](http://i.imgur.com/OwAfiUm.png)

测试结果还是不错的，识别率97.4%。说明我对于这份代码的理解是合理的，正确的。

## 编写自己的朴素贝叶斯 ##
由于这份代码被否定，我只能够自己再写一份。看过两份源代码之后，自己对于怎么实现有了准确的认识，已经有了思路。最重要是知道了应该如何存储需要数据的数据结构，所以花费了一个工作日的时间，编写完成，并加上了中文分词的功能。一共大概花费了10个小时。在完成自己的代码之后，我运行了该代码的执行结果。

![自己编写的朴素贝叶斯算法](http://i.imgur.com/DKJSlss.png)

识别率为99.36%。
我编写的java代码：（githubURL）

最难计算的一点在于，极大似然概率，使用如下公式。

![极大似然概率](http://i.imgur.com/dT4yFeg.png)

之所以我编写的代码识别率较高，是由于我们对于自己使用的场景优化了。并没有使用拉普拉斯平滑，而是使用10^-6 进行平滑操作。并且我的程序包含中文分词功能，能够很好的解决一大串字符输入的场景。

## 总结 ##
由于需求来比较匆忙，而我这个小组中有6个人，其中林伟海使用R语言，唐陈平使用C++，林伟伟偏重前端，团长庄勇没有使用java，并且主要负责需求。所以这个任务只能够是我来完成，只有一周的时间。一开始对朴素贝叶斯算法时完全不懂，花费了2天时间查找资料，以及理解。花费了1天的时间理解第一份github上的源代码，又花费1天时间理解第二根github上源代码。之后花费一天的时间编写出自己的源代码，有花费了一天的时间整理数据，编写测试代码，以及演示demo代码的准备。一共花费了6天的时间，其中一天是我的周六。所以说磨刀不误砍柴工，之所以能够快速完成在于自己对于这个算法时理解了。很多东西深奥，那是自己对这些东西不懂，一旦入门了，就会发现自己里正确答案越来越近。

